{"ast":null,"code":"var _jsxFileName = \"/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// ÁØÄÈªûÂ∞∫ÂØ∏Â∏∏Êï∏\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NODE_WIDTH = 140;\nconst NODE_HEIGHT = 80;\n\n// Ê†πÊìö type Áî¢Áîü‰∏çÂêåÁöÑÁØÄÈªûÂÖßÂÆπËàáÊ®£Âºè\nconst renderNodeContent = node => {\n  const commonStyle = {\n    padding: \"4px\",\n    textAlign: \"center\"\n  };\n  switch (node.type) {\n    case \"phase\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          justifyContent: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 16,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"12px\"\n          },\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 17,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 9\n      }, this);\n    case \"task\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 11\n        }, this), node.important && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: \"red\",\n            fontSize: \"10px\"\n          },\n          children: \"Important\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 24,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"12px\"\n          },\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this);\n    case \"subFlow\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"13px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"11px\"\n          },\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 9\n      }, this);\n    case \"iterative\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: [node.label, \" \\uD83D\\uDD04\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"12px\"\n          },\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, this);\n    case \"note\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontStyle: \"italic\",\n            fontSize: \"12px\"\n          },\n          children: node.text || node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"10px\"\n          },\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 9\n      }, this);\n    case \"extra\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          fontSize: \"10px\",\n          padding: \"2px\",\n          listStyle: \"disc\"\n        },\n        children: [\"\\u2022 \", node.content]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid black\"\n        },\n        children: node.label || \"No Label\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this);\n  }\n};\nconst CustomFlowChartEditor = () => {\n  _s();\n  const {\n    id: projectId\n  } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // ÁØÄÈªûË≥áÊñôÔºöÊØèÂÄãÁâ©‰ª∂Ëá≥Â∞ëÂåÖÂê´ id, type, label, description, children, extras, link, position\n  const [nodes, setNodes] = useState([]);\n  // ÂÑ≤Â≠òË¢´ÈÅ∏ÂèñÁ∑®ËºØÁöÑÁØÄÈªû id\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // ÊãñÊõ≥Áõ∏ÈóúÁãÄÊÖã\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // ËÆÄÂèñÂæåÁ´ØÊµÅÁ®ãÂúñË≥áÊñô\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        // È†êÊúü res.data ÁÇ∫‰∏ÄÂÄãÁâ©‰ª∂Èô£Âàó\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // ÊãñÊõ≥ÁØÄÈªûÔºöÊåâ‰∏ã\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top\n    });\n  };\n\n  // ÊãñÊõ≥ÔºöÁßªÂãï\n  const handleMouseMove = e => {\n    if (!draggingNodeId) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n    const newX = e.clientX - containerRect.left - dragOffset.x;\n    const newY = e.clientY - containerRect.top - dragOffset.y;\n    setNodes(prevNodes => prevNodes.map(n => n.id === draggingNodeId ? {\n      ...n,\n      position: {\n        x: newX,\n        y: newY\n      }\n    } : n));\n  };\n\n  // ÊãñÊõ≥ÁµêÊùü\n  const handleMouseUp = () => {\n    setDraggingNodeId(null);\n  };\n\n  // ÁØÄÈªûÈÅ∏ÂèñÔºàÈªûÈÅ∏ÂæåÁî®ÂÅ¥ÈÇäË°®ÂñÆÁ∑®ËºØÂ±¨ÊÄßÔºâ\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // ÂÅ¥ÈÇäÁ∑®ËºØÔºöÊõ¥Êñ∞Ë¢´ÈÅ∏ÁØÄÈªûÂ±¨ÊÄß\n  const handleEditChange = e => {\n    if (!selectedNodeId) return;\n    const {\n      name,\n      value\n    } = e.target;\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      [name]: value\n    } : n));\n  };\n\n  // ÁâπÂà•ËôïÁêÜ childrenÔºà‰ª•ÈÄóËôüÂàÜÈöîÁöÑÂ≠ó‰∏≤ËΩâÁÇ∫Èô£ÂàóÔºâ\n  const handleChildrenChange = e => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      children\n    } : n));\n  };\n\n  // Êñ∞Â¢ûÁØÄÈªûÔºöÊ†πÊìö‰ΩøÁî®ËÄÖÈúÄÊ±ÇÔºåÂèØÈ†êË®≠ type ÁÇ∫ task\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      // ‰ΩøÁî® timestamp Áï∂ÂîØ‰∏Ä ID\n      type: \"task\",\n      // È†êË®≠ÁÇ∫ taskÔºåÂèØÂæåÁ∫å‰øÆÊîπ\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: {\n        x: 50,\n        y: 50\n      }\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // ÂÑ≤Â≠òÊµÅÁ®ãÂúñË≥áÊñôÂà∞ÂæåÁ´Ø\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`, {\n        flowChart: nodes\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // ‰æùÊìöÊØèÂÄãÁØÄÈªûÁöÑ position Áï´Âá∫ÈÄ£Á∑öÔºàÁ∞°ÂñÆÁâàÔºöÂ¶ÇÊûúÁØÄÈªûÊúâ childrenÔºåÂæû parent ÈÄ£Âà∞ childÔºâ\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const startX = parent.position.x + NODE_WIDTH / 2;\n            const startY = parent.position.y + NODE_HEIGHT / 2;\n            const endX = child.position.x + NODE_WIDTH / 2;\n            const endY = child.position.y + NODE_HEIGHT / 2;\n            lines.push(/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: startX,\n              y1: startY,\n              x2: endX,\n              y2: endY,\n              stroke: \"black\",\n              strokeWidth: \"2\"\n            }, `line-${parent.id}-${child.id}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this));\n          }\n        });\n      }\n    });\n    return lines;\n  };\n\n  // ÂèñÂæóË¢´ÈÅ∏‰∏≠ÁØÄÈªûÔºå‰æõÂÅ¥ÈÇäË°®ÂñÆÁ∑®ËºØ\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Custom Flow Chart Editor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddNode,\n        children: \"Add Node\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        style: {\n          marginLeft: \"10px\"\n        },\n        children: \"Save Flow Chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        position: \"relative\",\n        width: \"100%\",\n        height: \"600px\",\n        border: \"1px solid #ccc\"\n      },\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        style: {\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\"\n        },\n        children: renderConnections()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), nodes.map(node => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: \"absolute\",\n          left: node.position.x,\n          top: node.position.y,\n          width: NODE_WIDTH,\n          height: NODE_HEIGHT,\n          cursor: \"move\",\n          boxSizing: \"border-box\"\n        },\n        onMouseDown: e => handleMouseDown(e, node.id),\n        onClick: e => handleSelectNode(e, node.id),\n        children: renderNodeContent(node)\n      }, node.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this), selectedNode && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"20px\",\n        border: \"1px solid #ccc\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Edit Node Properties\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Type:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"type\",\n          value: selectedNode.type,\n          onChange: handleEditChange,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"phase\",\n            children: \"phase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"task\",\n            children: \"task\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"subFlow\",\n            children: \"subFlow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"iterative\",\n            children: \"iterative\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"note\",\n            children: \"note\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"extra\",\n            children: \"extra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Label:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"label\",\n          value: selectedNode.label,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Description:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          value: selectedNode.description,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Link:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"link\",\n          value: selectedNode.link,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Children (comma-separated IDs):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: (selectedNode.children || []).join(\",\"),\n          onChange: handleChildrenChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Extras (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"extras\",\n          value: (selectedNode.extras || []).join(\",\"),\n          onChange: e => {\n            const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n            handleEditChange({\n              target: {\n                name: \"extras\",\n                value: arr\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomFlowChartEditor, \"VIn6OujlI4X7aFQEWrvfpkhD7nQ=\", false, function () {\n  return [useParams];\n});\n_c = CustomFlowChartEditor;\nexport default CustomFlowChartEditor;\nvar _c;\n$RefreshReg$(_c, \"CustomFlowChartEditor\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","useParams","jsxDEV","_jsxDEV","NODE_WIDTH","NODE_HEIGHT","renderNodeContent","node","commonStyle","padding","textAlign","type","style","border","backgroundColor","height","display","flexDirection","justifyContent","children","fontWeight","fontSize","label","fileName","_jsxFileName","lineNumber","columnNumber","description","important","color","fontStyle","text","listStyle","content","CustomFlowChartEditor","_s","id","projectId","token","localStorage","getItem","API_URL","process","env","REACT_APP_API_URL","containerRef","nodes","setNodes","selectedNodeId","setSelectedNodeId","draggingNodeId","setDraggingNodeId","dragOffset","setDragOffset","x","y","fetchFlowChart","res","get","headers","Authorization","data","error","console","handleMouseDown","e","nodeId","stopPropagation","nodeElem","currentTarget","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","containerRect","current","newX","newY","prevNodes","map","n","position","handleMouseUp","handleSelectNode","handleEditChange","name","value","target","handleChildrenChange","split","s","trim","filter","handleAddNode","newNode","Date","now","extras","link","prev","handleSave","put","flowChart","alert","renderConnections","lines","forEach","parent","Array","isArray","childId","child","find","startX","startY","endX","endY","push","x1","y1","x2","y2","stroke","strokeWidth","selectedNode","marginBottom","onClick","marginLeft","ref","width","onMouseMove","onMouseUp","cursor","boxSizing","onMouseDown","marginTop","onChange","join","arr","_c","$RefreshReg$"],"sources":["/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// ÁØÄÈªûÂ∞∫ÂØ∏Â∏∏Êï∏\nconst NODE_WIDTH = 140;\nconst NODE_HEIGHT = 80;\n\n// Ê†πÊìö type Áî¢Áîü‰∏çÂêåÁöÑÁØÄÈªûÂÖßÂÆπËàáÊ®£Âºè\nconst renderNodeContent = (node) => {\n  const commonStyle = { padding: \"4px\", textAlign: \"center\" };\n  switch(node.type) {\n    case \"phase\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px dashed blue\", backgroundColor: \"#e0f7ff\", height: \"100%\", display: \"flex\", flexDirection:\"column\", justifyContent:\"center\" }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label}</div>\n          <div style={{ fontSize: \"12px\" }}>{node.description}</div>\n        </div>\n      );\n    case \"task\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px solid black\", backgroundColor: \"#fff\" }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label}</div>\n          {node.important && <div style={{ color: \"red\", fontSize: \"10px\" }}>Important</div>}\n          <div style={{ fontSize: \"12px\" }}>{node.description}</div>\n        </div>\n      );\n    case \"subFlow\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px solid gray\", backgroundColor: \"#f0f0f0\" }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"13px\" }}>{node.label}</div>\n          <div style={{ fontSize: \"11px\" }}>{node.description}</div>\n        </div>\n      );\n    case \"iterative\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px dotted green\", backgroundColor: \"#e8ffe8\" }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label} üîÑ</div>\n          <div style={{ fontSize: \"12px\" }}>{node.description}</div>\n        </div>\n      );\n    case \"note\":\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid orange\", backgroundColor: \"#fff7d6\" }}>\n          <div style={{ fontStyle: \"italic\", fontSize: \"12px\" }}>{node.text || node.label}</div>\n          <div style={{ fontSize: \"10px\" }}>{node.description}</div>\n        </div>\n      );\n    case \"extra\":\n      return (\n        <div style={{ ...commonStyle, fontSize:\"10px\", padding: \"2px\", listStyle:\"disc\" }}>\n          ‚Ä¢ {node.content}\n        </div>\n      );\n    default:\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid black\" }}>\n          {node.label || \"No Label\"}\n        </div>\n      );\n  }\n};\n\nconst CustomFlowChartEditor = () => {\n  const { id: projectId } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // ÁØÄÈªûË≥áÊñôÔºöÊØèÂÄãÁâ©‰ª∂Ëá≥Â∞ëÂåÖÂê´ id, type, label, description, children, extras, link, position\n  const [nodes, setNodes] = useState([]);\n  // ÂÑ≤Â≠òË¢´ÈÅ∏ÂèñÁ∑®ËºØÁöÑÁØÄÈªû id\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // ÊãñÊõ≥Áõ∏ÈóúÁãÄÊÖã\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n\n  // ËÆÄÂèñÂæåÁ´ØÊµÅÁ®ãÂúñË≥áÊñô\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        // È†êÊúü res.data ÁÇ∫‰∏ÄÂÄãÁâ©‰ª∂Èô£Âàó\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // ÊãñÊõ≥ÁØÄÈªûÔºöÊåâ‰∏ã\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({ x: e.clientX - rect.left, y: e.clientY - rect.top });\n  };\n\n  // ÊãñÊõ≥ÔºöÁßªÂãï\n  const handleMouseMove = (e) => {\n    if (!draggingNodeId) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n    const newX = e.clientX - containerRect.left - dragOffset.x;\n    const newY = e.clientY - containerRect.top - dragOffset.y;\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === draggingNodeId ? { ...n, position: { x: newX, y: newY } } : n\n      )\n    );\n  };\n\n  // ÊãñÊõ≥ÁµêÊùü\n  const handleMouseUp = () => {\n    setDraggingNodeId(null);\n  };\n\n  // ÁØÄÈªûÈÅ∏ÂèñÔºàÈªûÈÅ∏ÂæåÁî®ÂÅ¥ÈÇäË°®ÂñÆÁ∑®ËºØÂ±¨ÊÄßÔºâ\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // ÂÅ¥ÈÇäÁ∑®ËºØÔºöÊõ¥Êñ∞Ë¢´ÈÅ∏ÁØÄÈªûÂ±¨ÊÄß\n  const handleEditChange = (e) => {\n    if (!selectedNodeId) return;\n    const { name, value } = e.target;\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, [name]: value } : n\n      )\n    );\n  };\n\n  // ÁâπÂà•ËôïÁêÜ childrenÔºà‰ª•ÈÄóËôüÂàÜÈöîÁöÑÂ≠ó‰∏≤ËΩâÁÇ∫Èô£ÂàóÔºâ\n  const handleChildrenChange = (e) => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, children } : n\n      )\n    );\n  };\n\n  // Êñ∞Â¢ûÁØÄÈªûÔºöÊ†πÊìö‰ΩøÁî®ËÄÖÈúÄÊ±ÇÔºåÂèØÈ†êË®≠ type ÁÇ∫ task\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,  // ‰ΩøÁî® timestamp Áï∂ÂîØ‰∏Ä ID\n      type: \"task\",         // È†êË®≠ÁÇ∫ taskÔºåÂèØÂæåÁ∫å‰øÆÊîπ\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: { x: 50, y: 50 }\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // ÂÑ≤Â≠òÊµÅÁ®ãÂúñË≥áÊñôÂà∞ÂæåÁ´Ø\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`,\n        { flowChart: nodes },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // ‰æùÊìöÊØèÂÄãÁØÄÈªûÁöÑ position Áï´Âá∫ÈÄ£Á∑öÔºàÁ∞°ÂñÆÁâàÔºöÂ¶ÇÊûúÁØÄÈªûÊúâ childrenÔºåÂæû parent ÈÄ£Âà∞ childÔºâ\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const startX = parent.position.x + NODE_WIDTH / 2;\n            const startY = parent.position.y + NODE_HEIGHT / 2;\n            const endX = child.position.x + NODE_WIDTH / 2;\n            const endY = child.position.y + NODE_HEIGHT / 2;\n            lines.push(\n              <line\n                key={`line-${parent.id}-${child.id}`}\n                x1={startX}\n                y1={startY}\n                x2={endX}\n                y2={endY}\n                stroke=\"black\"\n                strokeWidth=\"2\"\n              />\n            );\n          }\n        });\n      }\n    });\n    return lines;\n  };\n\n  // ÂèñÂæóË¢´ÈÅ∏‰∏≠ÁØÄÈªûÔºå‰æõÂÅ¥ÈÇäË°®ÂñÆÁ∑®ËºØ\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n\n  return (\n    <div>\n      <h2>Custom Flow Chart Editor</h2>\n      <div style={{ marginBottom: \"10px\" }}>\n        <button onClick={handleAddNode}>Add Node</button>\n        <button onClick={handleSave} style={{ marginLeft: \"10px\" }}>Save Flow Chart</button>\n      </div>\n      <div\n        ref={containerRef}\n        style={{ position: \"relative\", width: \"100%\", height: \"600px\", border: \"1px solid #ccc\" }}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n      >\n        <svg style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\" }}>\n          {renderConnections()}\n        </svg>\n        {nodes.map(node => (\n          <div\n            key={node.id}\n            style={{\n              position: \"absolute\",\n              left: node.position.x,\n              top: node.position.y,\n              width: NODE_WIDTH,\n              height: NODE_HEIGHT,\n              cursor: \"move\",\n              boxSizing: \"border-box\"\n            }}\n            onMouseDown={(e) => handleMouseDown(e, node.id)}\n            onClick={(e) => handleSelectNode(e, node.id)}\n          >\n            {renderNodeContent(node)}\n          </div>\n        ))}\n      </div>\n      {/* ÂÅ¥ÈÇäÁ∑®ËºØË°®ÂñÆ */}\n      {selectedNode && (\n        <div style={{ marginTop: \"20px\", border: \"1px solid #ccc\", padding: \"10px\" }}>\n          <h3>Edit Node Properties</h3>\n          <div>\n            <label>Type:</label>\n            <select name=\"type\" value={selectedNode.type} onChange={handleEditChange}>\n              <option value=\"phase\">phase</option>\n              <option value=\"task\">task</option>\n              <option value=\"subFlow\">subFlow</option>\n              <option value=\"iterative\">iterative</option>\n              <option value=\"note\">note</option>\n              <option value=\"extra\">extra</option>\n            </select>\n          </div>\n          <div>\n            <label>Label:</label>\n            <input name=\"label\" value={selectedNode.label} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Description:</label>\n            <textarea name=\"description\" value={selectedNode.description} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Link:</label>\n            <input name=\"link\" value={selectedNode.link} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Children (comma-separated IDs):</label>\n            <input\n              value={(selectedNode.children || []).join(\",\")}\n              onChange={handleChildrenChange}\n            />\n          </div>\n          <div>\n            <label>Extras (comma-separated):</label>\n            <input\n              name=\"extras\"\n              value={(selectedNode.extras || []).join(\",\")}\n              onChange={(e) => {\n                const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n                handleEditChange({ target: { name: \"extras\", value: arr } });\n              }}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CustomFlowChartEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}