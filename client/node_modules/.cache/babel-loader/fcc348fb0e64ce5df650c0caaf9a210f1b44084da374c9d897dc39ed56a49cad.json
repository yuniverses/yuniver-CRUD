{"ast":null,"code":"var _jsxFileName = \"/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx\",\n  _s = $RefreshSig$();\n// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// 節點尺寸常數：預設節點與 phase 節點不同尺寸\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEFAULT_NODE_WIDTH = 140;\nconst DEFAULT_NODE_HEIGHT = 80;\nconst PHASE_NODE_WIDTH = 300;\nconst PHASE_NODE_HEIGHT = 200;\nconst getNodeDimensions = node => {\n  if (node.type === 'phase') {\n    return {\n      width: PHASE_NODE_WIDTH,\n      height: PHASE_NODE_HEIGHT\n    };\n  }\n  return {\n    width: DEFAULT_NODE_WIDTH,\n    height: DEFAULT_NODE_HEIGHT\n  };\n};\n\n// 根據 type 產生節點內容與樣式\nconst renderNodeContent = node => {\n  const commonStyle = {\n    padding: \"4px\",\n    textAlign: \"center\",\n    fontSize: \"12px\"\n  };\n  switch (node.type) {\n    case \"phase\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          justifyContent: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 9\n      }, this);\n    case \"task\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 11\n        }, this), node.important && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: \"red\"\n          },\n          children: \"Important\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 9\n      }, this);\n    case \"subFlow\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }, this);\n    case \"iterative\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: [node.label, \" \\uD83D\\uDD04\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this);\n    case \"note\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontStyle: \"italic\"\n          },\n          children: node.text || node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this);\n    case \"extra\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          fontSize: \"10px\"\n        },\n        children: [\"\\u2022 \", node.content]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid black\"\n        },\n        children: node.label || \"No Label\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this);\n  }\n};\nconst CustomFlowChartEditor = () => {\n  _s();\n  const {\n    id: projectId\n  } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // 節點資料：每個物件包含 id, type, label, description, children, extras, link, position\n  const [nodes, setNodes] = useState([]);\n  // 被選中編輯的節點 id\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // 拖曳相關狀態\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // 讀取後端流程圖資料\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 拖曳開始：記錄拖曳節點與偏移量\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top\n    });\n  };\n\n  // 拖曳過程中更新節點位置\n  const handleMouseMove = e => {\n    if (!draggingNodeId) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n    const newX = e.clientX - containerRect.left - dragOffset.x;\n    const newY = e.clientY - containerRect.top - dragOffset.y;\n    setNodes(prevNodes => prevNodes.map(n => n.id === draggingNodeId ? {\n      ...n,\n      position: {\n        x: newX,\n        y: newY\n      }\n    } : n));\n  };\n\n  // 拖曳結束後檢查是否落入 phase 節點中\n  const handleMouseUp = () => {\n    if (draggingNodeId) {\n      const draggedNode = nodes.find(n => n.id === draggingNodeId);\n      if (draggedNode) {\n        const draggedCenter = {\n          x: draggedNode.position.x + getNodeDimensions(draggedNode).width / 2,\n          y: draggedNode.position.y + getNodeDimensions(draggedNode).height / 2\n        };\n        // 尋找所有 phase 節點，若拖曳中心位於 phase 節點內，則將該節點加入 phase 的 children\n        setNodes(prevNodes => prevNodes.map(n => {\n          if (n.type === 'phase' && n.id !== draggingNodeId) {\n            const {\n              width,\n              height\n            } = getNodeDimensions(n);\n            if (draggedCenter.x >= n.position.x && draggedCenter.x <= n.position.x + width && draggedCenter.y >= n.position.y && draggedCenter.y <= n.position.y + height) {\n              // 加入 children（避免重複）\n              const children = n.children ? [...n.children] : [];\n              if (!children.includes(draggingNodeId)) {\n                children.push(draggingNodeId);\n              }\n              return {\n                ...n,\n                children\n              };\n            }\n          }\n          return n;\n        }));\n      }\n    }\n    setDraggingNodeId(null);\n  };\n\n  // 節點選取以便編輯\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點：同時從所有父節點的 children 移除\n  const handleDeleteNode = nodeId => {\n    setNodes(prevNodes => prevNodes.filter(n => n.id !== nodeId).map(n => {\n      if (n.children && Array.isArray(n.children)) {\n        return {\n          ...n,\n          children: n.children.filter(childId => childId !== nodeId)\n        };\n      }\n      return n;\n    }));\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 側邊編輯：更新被選節點屬性（針對直接屬性，如 type、label、description、link）\n  const handleEditChange = e => {\n    if (!selectedNodeId) return;\n    const {\n      name,\n      value\n    } = e.target;\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      [name]: value\n    } : n));\n  };\n\n  // 特別處理 children（以逗號分隔的字串轉為陣列）\n  const handleChildrenChange = e => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      children\n    } : n));\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\",\n      // 預設 type 為 task\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: {\n        x: 50,\n        y: 50\n      }\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖 JSON 到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`, {\n        flowChart: nodes\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 渲染連線：根據每個節點的 children 欄位，從父節點中心連到子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const parentDims = getNodeDimensions(parent);\n            const childDims = getNodeDimensions(child);\n            const startX = parent.position.x + parentDims.width / 2;\n            const startY = parent.position.y + parentDims.height / 2;\n            const endX = child.position.x + childDims.width / 2;\n            const endY = child.position.y + childDims.height / 2;\n            lines.push(/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: startX,\n              y1: startY,\n              x2: endX,\n              y2: endY,\n              stroke: \"black\",\n              strokeWidth: \"2\"\n            }, `line-${parent.id}-${child.id}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this));\n          }\n        });\n      }\n    });\n    return lines;\n  };\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Custom Flow Chart Editor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddNode,\n        children: \"Add Node\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        style: {\n          marginLeft: \"10px\"\n        },\n        children: \"Save Flow Chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        position: \"relative\",\n        width: \"100%\",\n        height: \"600px\",\n        border: \"1px solid #ccc\"\n      },\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        style: {\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\"\n        },\n        children: renderConnections()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this), nodes.map(node => {\n        const dims = getNodeDimensions(node);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"absolute\",\n            left: node.position.x,\n            top: node.position.y,\n            width: dims.width,\n            height: dims.height,\n            boxSizing: \"border-box\",\n            cursor: \"move\"\n          },\n          onMouseDown: e => handleMouseDown(e, node.id),\n          onClick: e => handleSelectNode(e, node.id),\n          children: [renderNodeContent(node), /*#__PURE__*/_jsxDEV(\"button\", {\n            style: {\n              position: \"absolute\",\n              top: 0,\n              right: 0,\n              backgroundColor: \"red\",\n              color: \"#fff\",\n              border: \"none\",\n              cursor: \"pointer\",\n              fontSize: \"10px\",\n              padding: \"2px\"\n            },\n            onClick: e => {\n              e.stopPropagation();\n              handleDeleteNode(node.id);\n            },\n            children: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 15\n          }, this)]\n        }, node.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this), selectedNode && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"20px\",\n        border: \"1px solid #ccc\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Edit Node Properties\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Type:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"type\",\n          value: selectedNode.type,\n          onChange: handleEditChange,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"phase\",\n            children: \"phase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"task\",\n            children: \"task\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"subFlow\",\n            children: \"subFlow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"iterative\",\n            children: \"iterative\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"note\",\n            children: \"note\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"extra\",\n            children: \"extra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Label:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"label\",\n          value: selectedNode.label,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Description:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          value: selectedNode.description,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Link:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"link\",\n          value: selectedNode.link,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Children (comma-separated IDs):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: (selectedNode.children || []).join(\",\"),\n          onChange: handleChildrenChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Extras (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"extras\",\n          value: (selectedNode.extras || []).join(\",\"),\n          onChange: e => {\n            const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n            handleEditChange({\n              target: {\n                name: \"extras\",\n                value: arr\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 291,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomFlowChartEditor, \"VIn6OujlI4X7aFQEWrvfpkhD7nQ=\", false, function () {\n  return [useParams];\n});\n_c = CustomFlowChartEditor;\nexport default CustomFlowChartEditor;\nvar _c;\n$RefreshReg$(_c, \"CustomFlowChartEditor\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","useParams","jsxDEV","_jsxDEV","DEFAULT_NODE_WIDTH","DEFAULT_NODE_HEIGHT","PHASE_NODE_WIDTH","PHASE_NODE_HEIGHT","getNodeDimensions","node","type","width","height","renderNodeContent","commonStyle","padding","textAlign","fontSize","style","border","backgroundColor","display","flexDirection","justifyContent","children","fontWeight","label","fileName","_jsxFileName","lineNumber","columnNumber","description","important","color","fontStyle","text","content","CustomFlowChartEditor","_s","id","projectId","token","localStorage","getItem","API_URL","process","env","REACT_APP_API_URL","containerRef","nodes","setNodes","selectedNodeId","setSelectedNodeId","draggingNodeId","setDraggingNodeId","dragOffset","setDragOffset","x","y","fetchFlowChart","res","get","headers","Authorization","data","error","console","handleMouseDown","e","nodeId","stopPropagation","nodeElem","currentTarget","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","containerRect","current","newX","newY","prevNodes","map","n","position","handleMouseUp","draggedNode","find","draggedCenter","includes","push","handleSelectNode","handleDeleteNode","filter","Array","isArray","childId","handleEditChange","name","value","target","handleChildrenChange","split","s","trim","handleAddNode","newNode","Date","now","extras","link","prev","handleSave","put","flowChart","alert","renderConnections","lines","forEach","parent","child","parentDims","childDims","startX","startY","endX","endY","x1","y1","x2","y2","stroke","strokeWidth","selectedNode","marginBottom","onClick","marginLeft","ref","onMouseMove","onMouseUp","dims","boxSizing","cursor","onMouseDown","right","marginTop","onChange","join","arr","_c","$RefreshReg$"],"sources":["/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx"],"sourcesContent":["// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// 節點尺寸常數：預設節點與 phase 節點不同尺寸\nconst DEFAULT_NODE_WIDTH = 140;\nconst DEFAULT_NODE_HEIGHT = 80;\nconst PHASE_NODE_WIDTH = 300;\nconst PHASE_NODE_HEIGHT = 200;\n\nconst getNodeDimensions = (node) => {\n  if (node.type === 'phase') {\n    return { width: PHASE_NODE_WIDTH, height: PHASE_NODE_HEIGHT };\n  }\n  return { width: DEFAULT_NODE_WIDTH, height: DEFAULT_NODE_HEIGHT };\n};\n\n// 根據 type 產生節點內容與樣式\nconst renderNodeContent = (node) => {\n  const commonStyle = { padding: \"4px\", textAlign: \"center\", fontSize: \"12px\" };\n  switch(node.type) {\n    case \"phase\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection:\"column\",\n          justifyContent:\"center\"\n        }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"task\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          {node.important && <div style={{ color: \"red\" }}>Important</div>}\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"subFlow\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"iterative\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label} 🔄</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"note\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        }}>\n          <div style={{ fontStyle: \"italic\" }}>{node.text || node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"extra\":\n      return (\n        <div style={{ ...commonStyle, fontSize:\"10px\" }}>\n          • {node.content}\n        </div>\n      );\n    default:\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid black\" }}>\n          {node.label || \"No Label\"}\n        </div>\n      );\n  }\n};\n\nconst CustomFlowChartEditor = () => {\n  const { id: projectId } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // 節點資料：每個物件包含 id, type, label, description, children, extras, link, position\n  const [nodes, setNodes] = useState([]);\n  // 被選中編輯的節點 id\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // 拖曳相關狀態\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n\n  // 讀取後端流程圖資料\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 拖曳開始：記錄拖曳節點與偏移量\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({ x: e.clientX - rect.left, y: e.clientY - rect.top });\n  };\n\n  // 拖曳過程中更新節點位置\n  const handleMouseMove = (e) => {\n    if (!draggingNodeId) return;\n    const containerRect = containerRef.current.getBoundingClientRect();\n    const newX = e.clientX - containerRect.left - dragOffset.x;\n    const newY = e.clientY - containerRect.top - dragOffset.y;\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === draggingNodeId ? { ...n, position: { x: newX, y: newY } } : n\n      )\n    );\n  };\n\n  // 拖曳結束後檢查是否落入 phase 節點中\n  const handleMouseUp = () => {\n    if (draggingNodeId) {\n      const draggedNode = nodes.find(n => n.id === draggingNodeId);\n      if (draggedNode) {\n        const draggedCenter = {\n          x: draggedNode.position.x + getNodeDimensions(draggedNode).width / 2,\n          y: draggedNode.position.y + getNodeDimensions(draggedNode).height / 2,\n        };\n        // 尋找所有 phase 節點，若拖曳中心位於 phase 節點內，則將該節點加入 phase 的 children\n        setNodes(prevNodes =>\n          prevNodes.map(n => {\n            if (n.type === 'phase' && n.id !== draggingNodeId) {\n              const { width, height } = getNodeDimensions(n);\n              if (\n                draggedCenter.x >= n.position.x &&\n                draggedCenter.x <= n.position.x + width &&\n                draggedCenter.y >= n.position.y &&\n                draggedCenter.y <= n.position.y + height\n              ) {\n                // 加入 children（避免重複）\n                const children = n.children ? [...n.children] : [];\n                if (!children.includes(draggingNodeId)) {\n                  children.push(draggingNodeId);\n                }\n                return { ...n, children };\n              }\n            }\n            return n;\n          })\n        );\n      }\n    }\n    setDraggingNodeId(null);\n  };\n\n  // 節點選取以便編輯\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點：同時從所有父節點的 children 移除\n  const handleDeleteNode = (nodeId) => {\n    setNodes(prevNodes => prevNodes\n      .filter(n => n.id !== nodeId)\n      .map(n => {\n        if (n.children && Array.isArray(n.children)) {\n          return { ...n, children: n.children.filter(childId => childId !== nodeId) };\n        }\n        return n;\n      })\n    );\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 側邊編輯：更新被選節點屬性（針對直接屬性，如 type、label、description、link）\n  const handleEditChange = (e) => {\n    if (!selectedNodeId) return;\n    const { name, value } = e.target;\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, [name]: value } : n\n      )\n    );\n  };\n\n  // 特別處理 children（以逗號分隔的字串轉為陣列）\n  const handleChildrenChange = (e) => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, children } : n\n      )\n    );\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\", // 預設 type 為 task\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: { x: 50, y: 50 }\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖 JSON 到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`,\n        { flowChart: nodes },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 渲染連線：根據每個節點的 children 欄位，從父節點中心連到子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const parentDims = getNodeDimensions(parent);\n            const childDims = getNodeDimensions(child);\n            const startX = parent.position.x + parentDims.width / 2;\n            const startY = parent.position.y + parentDims.height / 2;\n            const endX = child.position.x + childDims.width / 2;\n            const endY = child.position.y + childDims.height / 2;\n            lines.push(\n              <line\n                key={`line-${parent.id}-${child.id}`}\n                x1={startX}\n                y1={startY}\n                x2={endX}\n                y2={endY}\n                stroke=\"black\"\n                strokeWidth=\"2\"\n              />\n            );\n          }\n        });\n      }\n    });\n    return lines;\n  };\n\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n\n  return (\n    <div>\n      <h2>Custom Flow Chart Editor</h2>\n      <div style={{ marginBottom: \"10px\" }}>\n        <button onClick={handleAddNode}>Add Node</button>\n        <button onClick={handleSave} style={{ marginLeft: \"10px\" }}>Save Flow Chart</button>\n      </div>\n      <div\n        ref={containerRef}\n        style={{ position: \"relative\", width: \"100%\", height: \"600px\", border: \"1px solid #ccc\" }}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n      >\n        <svg style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\" }}>\n          {renderConnections()}\n        </svg>\n        {nodes.map(node => {\n          const dims = getNodeDimensions(node);\n          return (\n            <div\n              key={node.id}\n              style={{\n                position: \"absolute\",\n                left: node.position.x,\n                top: node.position.y,\n                width: dims.width,\n                height: dims.height,\n                boxSizing: \"border-box\",\n                cursor: \"move\"\n              }}\n              onMouseDown={(e) => handleMouseDown(e, node.id)}\n              onClick={(e) => handleSelectNode(e, node.id)}\n            >\n              {renderNodeContent(node)}\n              <button\n                style={{\n                  position: \"absolute\",\n                  top: 0,\n                  right: 0,\n                  backgroundColor: \"red\",\n                  color: \"#fff\",\n                  border: \"none\",\n                  cursor: \"pointer\",\n                  fontSize: \"10px\",\n                  padding: \"2px\"\n                }}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleDeleteNode(node.id);\n                }}\n              >\n                X\n              </button>\n            </div>\n          );\n        })}\n      </div>\n      {selectedNode && (\n        <div style={{ marginTop: \"20px\", border: \"1px solid #ccc\", padding: \"10px\" }}>\n          <h3>Edit Node Properties</h3>\n          <div>\n            <label>Type:</label>\n            <select name=\"type\" value={selectedNode.type} onChange={handleEditChange}>\n              <option value=\"phase\">phase</option>\n              <option value=\"task\">task</option>\n              <option value=\"subFlow\">subFlow</option>\n              <option value=\"iterative\">iterative</option>\n              <option value=\"note\">note</option>\n              <option value=\"extra\">extra</option>\n            </select>\n          </div>\n          <div>\n            <label>Label:</label>\n            <input name=\"label\" value={selectedNode.label} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Description:</label>\n            <textarea name=\"description\" value={selectedNode.description} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Link:</label>\n            <input name=\"link\" value={selectedNode.link} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Children (comma-separated IDs):</label>\n            <input\n              value={(selectedNode.children || []).join(\",\")}\n              onChange={handleChildrenChange}\n            />\n          </div>\n          <div>\n            <label>Extras (comma-separated):</label>\n            <input\n              name=\"extras\"\n              value={(selectedNode.extras || []).join(\",\")}\n              onChange={(e) => {\n                const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n                handleEditChange({ target: { name: \"extras\", value: arr } });\n              }}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CustomFlowChartEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}