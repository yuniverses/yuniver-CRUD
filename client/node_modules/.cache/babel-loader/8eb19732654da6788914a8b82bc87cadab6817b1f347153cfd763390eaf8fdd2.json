{"ast":null,"code":"var _jsxFileName = \"/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx\",\n  _s = $RefreshSig$();\n// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEFAULT_NODE_SIZE = {\n  width: 140,\n  height: 80\n};\nconst DEFAULT_PHASE_SIZE = {\n  width: 150,\n  height: 100\n};\nconst getDefaultSize = node => {\n  return node.type === 'phase' ? DEFAULT_PHASE_SIZE : DEFAULT_NODE_SIZE;\n};\nconst renderNodeContent = node => {\n  const commonStyle = {\n    padding: \"4px\",\n    textAlign: \"center\",\n    fontSize: \"12px\"\n  };\n  switch (node.type) {\n    case \"phase\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          justifyContent: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 9\n      }, this);\n    case \"task\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 11\n        }, this), node.important && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: \"red\"\n          },\n          children: \"Important\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this);\n    case \"subFlow\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this);\n    case \"iterative\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: [node.label, \" \\uD83D\\uDD04\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this);\n    case \"note\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontStyle: \"italic\"\n          },\n          children: node.text || node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this);\n    case \"extra\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          fontSize: \"10px\"\n        },\n        children: [\"\\u2022 \", node.content]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid black\"\n        },\n        children: node.label || \"No Label\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this);\n  }\n};\nconst CustomFlowChartEditor = () => {\n  _s();\n  const {\n    id: projectId\n  } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // nodes: 每個節點包含 id, type, label, description, link, extras, children (array), position, size\n  const [nodes, setNodes] = useState([]);\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [resizingNodeId, setResizingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  });\n  const [resizeStart, setResizeStart] = useState({\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  });\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const data = res.data || [];\n        // 確保每個節點有 size 欄位\n        const enriched = data.map(node => ({\n          ...node,\n          size: node.size || getDefaultSize(node)\n        }));\n        setNodes(enriched);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 拖曳節點：開始拖動時記錄偏移\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top\n    });\n  };\n  const handleMouseMove = e => {\n    if (draggingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newX = e.clientX - containerRect.left - dragOffset.x;\n      const newY = e.clientY - containerRect.top - dragOffset.y;\n      setNodes(prevNodes => prevNodes.map(n => {\n        if (n.id === draggingNodeId) {\n          const deltaX = newX - n.position.x;\n          const deltaY = newY - n.position.y;\n          // 若此節點為 phase，則同時移動所有其 children 節點\n          if (n.type === 'phase' && n.children && n.children.length > 0) {\n            return {\n              ...n,\n              position: {\n                x: newX,\n                y: newY\n              }\n            };\n          }\n          return {\n            ...n,\n            position: {\n              x: newX,\n              y: newY\n            }\n          };\n        }\n        // 若此節點屬於某個 phase正在被拖動，則一併更新位置\n        const parent = prevNodes.find(p => p.type === 'phase' && p.children && p.children.includes(draggingNodeId));\n        if (parent && n.id === draggingNodeId) {\n          // 這裡我們只拖動 phase 自身\n          return n;\n        }\n        return n;\n      }));\n    }\n  };\n  const handleMouseUp = () => {\n    // 檢查如果一個非 phase 節點被拖入 phase 節點區域，則加入 phase 的 children\n    if (draggingNodeId) {\n      const draggedNode = nodes.find(n => n.id === draggingNodeId);\n      if (draggedNode) {\n        const draggedCenter = {\n          x: draggedNode.position.x + draggedNode.size.width / 2,\n          y: draggedNode.position.y + draggedNode.size.height / 2\n        };\n        setNodes(prevNodes => prevNodes.map(n => {\n          if (n.type === 'phase' && n.id !== draggingNodeId) {\n            const {\n              x,\n              y\n            } = n.position;\n            const {\n              width,\n              height\n            } = n.size;\n            if (draggedCenter.x >= x && draggedCenter.x <= x + width && draggedCenter.y >= y && draggedCenter.y <= y + height) {\n              // 將 draggedNode 加入 phase 的 children（避免重複）\n              const children = n.children ? [...n.children] : [];\n              if (!children.includes(draggingNodeId)) {\n                children.push(draggingNodeId);\n              }\n              return {\n                ...n,\n                children\n              };\n            }\n          }\n          return n;\n        }));\n      }\n    }\n    setDraggingNodeId(null);\n  };\n\n  // 調整大小：右下角手柄的拖曳\n  const handleResizeMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    setResizingNodeId(nodeId);\n    const node = nodes.find(n => n.id === nodeId);\n    setResizeStart({\n      x: e.clientX,\n      y: e.clientY,\n      width: node.size.width,\n      height: node.size.height\n    });\n  };\n  const handleResizeMouseMove = e => {\n    if (!resizingNodeId) return;\n    const deltaX = e.clientX - resizeStart.x;\n    const deltaY = e.clientY - resizeStart.y;\n    setNodes(prevNodes => prevNodes.map(n => {\n      if (n.id === resizingNodeId) {\n        return {\n          ...n,\n          size: {\n            width: Math.max(50, resizeStart.width + deltaX),\n            height: Math.max(30, resizeStart.height + deltaY)\n          }\n        };\n      }\n      return n;\n    }));\n  };\n  const handleResizeMouseUp = () => {\n    setResizingNodeId(null);\n  };\n\n  // 節點選取\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點（同時從所有父節點 children 移除）\n  const handleDeleteNode = nodeId => {\n    setNodes(prevNodes => prevNodes.filter(n => n.id !== nodeId).map(n => n.children ? {\n      ...n,\n      children: n.children.filter(cid => cid !== nodeId)\n    } : n));\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 側邊表單更新（直接屬性）\n  const handleEditChange = e => {\n    if (!selectedNodeId) return;\n    const {\n      name,\n      value\n    } = e.target;\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      [name]: value\n    } : n));\n  };\n  const handleChildrenChange = e => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      children\n    } : n));\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\",\n      // 預設 type 為 task\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: {\n        x: 50,\n        y: 50\n      },\n      size: DEFAULT_NODE_SIZE\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`, {\n        flowChart: nodes\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 使用 SVG 畫連線：從每個 phase 的中心到其子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const pDims = parent.size;\n            const cDims = child.size;\n            const startX = parent.position.x + pDims.width / 2;\n            const startY = parent.position.y + pDims.height / 2;\n            const endX = child.position.x + cDims.width / 2;\n            const endY = child.position.y + cDims.height / 2;\n            lines.push(/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: startX,\n              y1: startY,\n              x2: endX,\n              y2: endY,\n              stroke: \"black\",\n              strokeWidth: \"2\"\n            }, `line-${parent.id}-${child.id}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 15\n            }, this));\n          }\n        });\n      }\n    });\n    return lines;\n  };\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Custom Flow Chart Editor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddNode,\n        children: \"Add Node\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        style: {\n          marginLeft: \"10px\"\n        },\n        children: \"Save Flow Chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        position: \"relative\",\n        width: \"100%\",\n        height: \"600px\",\n        border: \"1px solid #ccc\"\n      },\n      onMouseMove: e => {\n        handleMouseMove(e);\n        handleResizeMouseMove(e);\n      },\n      onMouseUp: () => {\n        handleMouseUp();\n        handleResizeMouseUp();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        style: {\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\"\n        },\n        children: renderConnections()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), nodes.map(node => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: \"absolute\",\n          left: node.position.x,\n          top: node.position.y,\n          width: node.size.width,\n          height: node.size.height,\n          boxSizing: \"border-box\",\n          cursor: \"move\",\n          border: selectedNodeId === node.id ? \"2px solid blue\" : \"1px solid #000\",\n          backgroundColor: \"#fff\"\n        },\n        onMouseDown: e => handleMouseDown(e, node.id),\n        onClick: e => handleSelectNode(e, node.id),\n        children: [renderNodeContent(node), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            position: \"absolute\",\n            top: 0,\n            right: 0,\n            backgroundColor: \"red\",\n            color: \"#fff\",\n            border: \"none\",\n            cursor: \"pointer\",\n            fontSize: \"10px\",\n            padding: \"2px\"\n          },\n          onClick: e => {\n            e.stopPropagation();\n            handleDeleteNode(node.id);\n          },\n          children: \"X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }, this), selectedNodeId === node.id && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"absolute\",\n            right: 0,\n            bottom: 0,\n            width: \"10px\",\n            height: \"10px\",\n            backgroundColor: \"gray\",\n            cursor: \"nwse-resize\"\n          },\n          onMouseDown: e => handleResizeMouseDown(e, node.id)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 15\n        }, this)]\n      }, node.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this), selectedNode && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"20px\",\n        border: \"1px solid #ccc\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Edit Node Properties\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Type:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"type\",\n          value: selectedNode.type,\n          onChange: handleEditChange,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"phase\",\n            children: \"phase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"task\",\n            children: \"task\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"subFlow\",\n            children: \"subFlow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"iterative\",\n            children: \"iterative\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"note\",\n            children: \"note\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"extra\",\n            children: \"extra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Label:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"label\",\n          value: selectedNode.label,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Description:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          value: selectedNode.description,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Link:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"link\",\n          value: selectedNode.link,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Children (comma-separated IDs):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: (selectedNode.children || []).join(\",\"),\n          onChange: handleChildrenChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Extras (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"extras\",\n          value: (selectedNode.extras || []).join(\",\"),\n          onChange: e => {\n            const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n            handleEditChange({\n              target: {\n                name: \"extras\",\n                value: arr\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 323,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomFlowChartEditor, \"Bj+V9+fltUw3d9pH67eTwW9yX5Y=\", false, function () {\n  return [useParams];\n});\n_c = CustomFlowChartEditor;\nexport default CustomFlowChartEditor;\nvar _c;\n$RefreshReg$(_c, \"CustomFlowChartEditor\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","useParams","jsxDEV","_jsxDEV","DEFAULT_NODE_SIZE","width","height","DEFAULT_PHASE_SIZE","getDefaultSize","node","type","renderNodeContent","commonStyle","padding","textAlign","fontSize","style","border","backgroundColor","display","flexDirection","justifyContent","children","fontWeight","label","fileName","_jsxFileName","lineNumber","columnNumber","description","important","color","fontStyle","text","content","CustomFlowChartEditor","_s","id","projectId","token","localStorage","getItem","API_URL","process","env","REACT_APP_API_URL","containerRef","nodes","setNodes","selectedNodeId","setSelectedNodeId","draggingNodeId","setDraggingNodeId","resizingNodeId","setResizingNodeId","dragOffset","setDragOffset","x","y","resizeStart","setResizeStart","fetchFlowChart","res","get","headers","Authorization","data","enriched","map","size","error","console","handleMouseDown","e","nodeId","stopPropagation","nodeElem","currentTarget","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","containerRect","current","newX","newY","prevNodes","n","deltaX","position","deltaY","length","parent","find","p","includes","handleMouseUp","draggedNode","draggedCenter","push","handleResizeMouseDown","handleResizeMouseMove","Math","max","handleResizeMouseUp","handleSelectNode","handleDeleteNode","filter","cid","handleEditChange","name","value","target","handleChildrenChange","split","s","trim","handleAddNode","newNode","Date","now","extras","link","prev","handleSave","put","flowChart","alert","renderConnections","lines","forEach","Array","isArray","childId","child","pDims","cDims","startX","startY","endX","endY","x1","y1","x2","y2","stroke","strokeWidth","selectedNode","marginBottom","onClick","marginLeft","ref","onMouseMove","onMouseUp","boxSizing","cursor","onMouseDown","right","bottom","marginTop","onChange","join","arr","_c","$RefreshReg$"],"sources":["/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx"],"sourcesContent":["// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\nconst DEFAULT_NODE_SIZE = { width: 140, height: 80 };\nconst DEFAULT_PHASE_SIZE = { width: 150, height: 100 };\n\nconst getDefaultSize = (node) => {\n  return node.type === 'phase' ? DEFAULT_PHASE_SIZE : DEFAULT_NODE_SIZE;\n};\n\nconst renderNodeContent = (node) => {\n  const commonStyle = { padding: \"4px\", textAlign: \"center\", fontSize: \"12px\" };\n  switch(node.type) {\n    case \"phase\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection:\"column\",\n          justifyContent:\"center\"\n        }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"task\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          {node.important && <div style={{ color: \"red\" }}>Important</div>}\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"subFlow\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"iterative\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label} 🔄</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"note\":\n      return (\n        <div style={{\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        }}>\n          <div style={{ fontStyle: \"italic\" }}>{node.text || node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"extra\":\n      return (\n        <div style={{ ...commonStyle, fontSize:\"10px\" }}>\n          • {node.content}\n        </div>\n      );\n    default:\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid black\" }}>\n          {node.label || \"No Label\"}\n        </div>\n      );\n  }\n};\n\nconst CustomFlowChartEditor = () => {\n  const { id: projectId } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // nodes: 每個節點包含 id, type, label, description, link, extras, children (array), position, size\n  const [nodes, setNodes] = useState([]);\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [resizingNodeId, setResizingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  const [resizeStart, setResizeStart] = useState({ x: 0, y: 0, width: 0, height: 0 });\n\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        const data = res.data || [];\n        // 確保每個節點有 size 欄位\n        const enriched = data.map(node => ({\n          ...node,\n          size: node.size || getDefaultSize(node)\n        }));\n        setNodes(enriched);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 拖曳節點：開始拖動時記錄偏移\n  const handleMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    const nodeElem = e.currentTarget;\n    const rect = nodeElem.getBoundingClientRect();\n    setDraggingNodeId(nodeId);\n    setDragOffset({ x: e.clientX - rect.left, y: e.clientY - rect.top });\n  };\n\n  const handleMouseMove = (e) => {\n    if (draggingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newX = e.clientX - containerRect.left - dragOffset.x;\n      const newY = e.clientY - containerRect.top - dragOffset.y;\n      setNodes(prevNodes => prevNodes.map(n => {\n        if (n.id === draggingNodeId) {\n          const deltaX = newX - n.position.x;\n          const deltaY = newY - n.position.y;\n          // 若此節點為 phase，則同時移動所有其 children 節點\n          if (n.type === 'phase' && n.children && n.children.length > 0) {\n            return { ...n, position: { x: newX, y: newY } };\n          }\n          return { ...n, position: { x: newX, y: newY } };\n        }\n        // 若此節點屬於某個 phase正在被拖動，則一併更新位置\n        const parent = prevNodes.find(p => p.type === 'phase' && p.children && p.children.includes(draggingNodeId));\n        if (parent && n.id === draggingNodeId) {\n          // 這裡我們只拖動 phase 自身\n          return n;\n        }\n        return n;\n      }));\n    }\n  };\n\n  const handleMouseUp = () => {\n    // 檢查如果一個非 phase 節點被拖入 phase 節點區域，則加入 phase 的 children\n    if (draggingNodeId) {\n      const draggedNode = nodes.find(n => n.id === draggingNodeId);\n      if (draggedNode) {\n        const draggedCenter = {\n          x: draggedNode.position.x + draggedNode.size.width / 2,\n          y: draggedNode.position.y + draggedNode.size.height / 2,\n        };\n        setNodes(prevNodes =>\n          prevNodes.map(n => {\n            if (n.type === 'phase' && n.id !== draggingNodeId) {\n              const { x, y } = n.position;\n              const { width, height } = n.size;\n              if (\n                draggedCenter.x >= x &&\n                draggedCenter.x <= x + width &&\n                draggedCenter.y >= y &&\n                draggedCenter.y <= y + height\n              ) {\n                // 將 draggedNode 加入 phase 的 children（避免重複）\n                const children = n.children ? [...n.children] : [];\n                if (!children.includes(draggingNodeId)) {\n                  children.push(draggingNodeId);\n                }\n                return { ...n, children };\n              }\n            }\n            return n;\n          })\n        );\n      }\n    }\n    setDraggingNodeId(null);\n  };\n\n  // 調整大小：右下角手柄的拖曳\n  const handleResizeMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    setResizingNodeId(nodeId);\n    const node = nodes.find(n => n.id === nodeId);\n    setResizeStart({ x: e.clientX, y: e.clientY, width: node.size.width, height: node.size.height });\n  };\n\n  const handleResizeMouseMove = (e) => {\n    if (!resizingNodeId) return;\n    const deltaX = e.clientX - resizeStart.x;\n    const deltaY = e.clientY - resizeStart.y;\n    setNodes(prevNodes => prevNodes.map(n => {\n      if (n.id === resizingNodeId) {\n        return {\n          ...n,\n          size: {\n            width: Math.max(50, resizeStart.width + deltaX),\n            height: Math.max(30, resizeStart.height + deltaY)\n          }\n        };\n      }\n      return n;\n    }));\n  };\n\n  const handleResizeMouseUp = () => {\n    setResizingNodeId(null);\n  };\n\n  // 節點選取\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點（同時從所有父節點 children 移除）\n  const handleDeleteNode = (nodeId) => {\n    setNodes(prevNodes => prevNodes\n      .filter(n => n.id !== nodeId)\n      .map(n => n.children ? { ...n, children: n.children.filter(cid => cid !== nodeId) } : n)\n    );\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 側邊表單更新（直接屬性）\n  const handleEditChange = (e) => {\n    if (!selectedNodeId) return;\n    const { name, value } = e.target;\n    setNodes(prevNodes => prevNodes.map(n =>\n      n.id === selectedNodeId ? { ...n, [name]: value } : n\n    ));\n  };\n\n  const handleChildrenChange = (e) => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes => prevNodes.map(n =>\n      n.id === selectedNodeId ? { ...n, children } : n\n    ));\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\", // 預設 type 為 task\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: { x: 50, y: 50 },\n      size: DEFAULT_NODE_SIZE\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`,\n        { flowChart: nodes },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 使用 SVG 畫連線：從每個 phase 的中心到其子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const pDims = parent.size;\n            const cDims = child.size;\n            const startX = parent.position.x + pDims.width / 2;\n            const startY = parent.position.y + pDims.height / 2;\n            const endX = child.position.x + cDims.width / 2;\n            const endY = child.position.y + cDims.height / 2;\n            lines.push(\n              <line\n                key={`line-${parent.id}-${child.id}`}\n                x1={startX}\n                y1={startY}\n                x2={endX}\n                y2={endY}\n                stroke=\"black\"\n                strokeWidth=\"2\"\n              />\n            );\n          }\n        });\n      }\n    });\n    return lines;\n  };\n\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n\n  return (\n    <div>\n      <h2>Custom Flow Chart Editor</h2>\n      <div style={{ marginBottom: \"10px\" }}>\n        <button onClick={handleAddNode}>Add Node</button>\n        <button onClick={handleSave} style={{ marginLeft: \"10px\" }}>Save Flow Chart</button>\n      </div>\n      <div\n        ref={containerRef}\n        style={{ position: \"relative\", width: \"100%\", height: \"600px\", border: \"1px solid #ccc\" }}\n        onMouseMove={(e) => {\n          handleMouseMove(e);\n          handleResizeMouseMove(e);\n        }}\n        onMouseUp={() => {\n          handleMouseUp();\n          handleResizeMouseUp();\n        }}\n      >\n        <svg style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\" }}>\n          {renderConnections()}\n        </svg>\n        {nodes.map(node => (\n          <div\n            key={node.id}\n            style={{\n              position: \"absolute\",\n              left: node.position.x,\n              top: node.position.y,\n              width: node.size.width,\n              height: node.size.height,\n              boxSizing: \"border-box\",\n              cursor: \"move\",\n              border: selectedNodeId === node.id ? \"2px solid blue\" : \"1px solid #000\",\n              backgroundColor: \"#fff\"\n            }}\n            onMouseDown={(e) => handleMouseDown(e, node.id)}\n            onClick={(e) => handleSelectNode(e, node.id)}\n          >\n            {renderNodeContent(node)}\n            <button\n              style={{\n                position: \"absolute\",\n                top: 0,\n                right: 0,\n                backgroundColor: \"red\",\n                color: \"#fff\",\n                border: \"none\",\n                cursor: \"pointer\",\n                fontSize: \"10px\",\n                padding: \"2px\"\n              }}\n              onClick={(e) => {\n                e.stopPropagation();\n                handleDeleteNode(node.id);\n              }}\n            >\n              X\n            </button>\n            {/* 顯示調整大小手柄 */}\n            {selectedNodeId === node.id && (\n              <div\n                style={{\n                  position: \"absolute\",\n                  right: 0,\n                  bottom: 0,\n                  width: \"10px\",\n                  height: \"10px\",\n                  backgroundColor: \"gray\",\n                  cursor: \"nwse-resize\"\n                }}\n                onMouseDown={(e) => handleResizeMouseDown(e, node.id)}\n              ></div>\n            )}\n          </div>\n        ))}\n      </div>\n      {selectedNode && (\n        <div style={{ marginTop: \"20px\", border: \"1px solid #ccc\", padding: \"10px\" }}>\n          <h3>Edit Node Properties</h3>\n          <div>\n            <label>Type:</label>\n            <select name=\"type\" value={selectedNode.type} onChange={handleEditChange}>\n              <option value=\"phase\">phase</option>\n              <option value=\"task\">task</option>\n              <option value=\"subFlow\">subFlow</option>\n              <option value=\"iterative\">iterative</option>\n              <option value=\"note\">note</option>\n              <option value=\"extra\">extra</option>\n            </select>\n          </div>\n          <div>\n            <label>Label:</label>\n            <input name=\"label\" value={selectedNode.label} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Description:</label>\n            <textarea name=\"description\" value={selectedNode.description} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Link:</label>\n            <input name=\"link\" value={selectedNode.link} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Children (comma-separated IDs):</label>\n            <input\n              value={(selectedNode.children || []).join(\",\")}\n              onChange={handleChildrenChange}\n            />\n          </div>\n          <div>\n            <label>Extras (comma-separated):</label>\n            <input\n              name=\"extras\"\n              value={(selectedNode.extras || []).join(\",\")}\n              onChange={(e) => {\n                const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n                handleEditChange({ target: { name: \"extras\", value: arr } });\n              }}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CustomFlowChartEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}