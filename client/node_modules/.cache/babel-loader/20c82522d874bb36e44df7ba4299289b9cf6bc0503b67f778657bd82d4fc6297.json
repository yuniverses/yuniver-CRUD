{"ast":null,"code":"var _jsxFileName = \"/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx\",\n  _s = $RefreshSig$();\n// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// 預設尺寸與 Phase 尺寸\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DEFAULT_SIZE = {\n  width: 140,\n  height: 80\n};\nconst PHASE_SIZE = {\n  width: 300,\n  height: 200\n};\nconst RESIZE_HANDLE_SIZE = 10;\nconst PHASE_PADDING = 20; // Phase 自動包覆子節點時的額外邊距\n\n// 根據節點 type 與是否有手動調整過尺寸，決定實際尺寸\nconst getNodeSize = node => {\n  if (node.width && node.height) {\n    return {\n      width: node.width,\n      height: node.height\n    };\n  }\n  return node.type === 'phase' ? PHASE_SIZE : DEFAULT_SIZE;\n};\n\n// 根據 type 產生不同的節點內容與樣式\nconst renderNodeContent = node => {\n  const commonStyle = {\n    padding: \"4px\",\n    textAlign: \"center\",\n    fontSize: \"12px\",\n    height: \"100%\",\n    boxSizing: \"border-box\"\n  };\n  switch (node.type) {\n    case \"phase\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dashed blue\",\n          backgroundColor: \"#e0f7ff\",\n          overflow: \"hidden\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"14px\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this);\n    case \"task\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid black\",\n          backgroundColor: \"#fff\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 11\n        }, this), node.important && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: \"red\"\n          },\n          children: \"Important\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this);\n    case \"subFlow\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px solid gray\",\n          backgroundColor: \"#f0f0f0\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this);\n    case \"iterative\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"2px dotted green\",\n          backgroundColor: \"#e8ffe8\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: \"bold\"\n          },\n          children: [node.label, \" \\uD83D\\uDD04\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this);\n    case \"note\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid orange\",\n          backgroundColor: \"#fff7d6\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontStyle: \"italic\"\n          },\n          children: node.text || node.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: node.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this);\n    case \"extra\":\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          fontSize: \"10px\"\n        },\n        children: [\"\\u2022 \", node.content]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...commonStyle,\n          border: \"1px solid black\"\n        },\n        children: node.label || \"No Label\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this);\n  }\n};\nconst CustomFlowChartEditor = () => {\n  _s();\n  const {\n    id: projectId\n  } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // 所有節點資料，格式包含：id, type, label, description, extras, link, children, position, width, height\n  const [nodes, setNodes] = useState([]);\n  // 選取狀態\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // 拖曳狀態\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  });\n  // 調整大小狀態\n  const [resizingNodeId, setResizingNodeId] = useState(null);\n  const [resizeStart, setResizeStart] = useState({\n    x: 0,\n    y: 0\n  });\n  const [initialSize, setInitialSize] = useState({\n    width: 0,\n    height: 0\n  });\n\n  // 讀取流程圖資料\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 依據拖曳狀態更新節點位置\n  const handleMouseMove = e => {\n    // 若正在拖曳\n    if (draggingNodeId && !resizingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newX = e.clientX - containerRect.left - dragOffset.x;\n      const newY = e.clientY - containerRect.top - dragOffset.y;\n      setNodes(prevNodes => prevNodes.map(n => {\n        if (n.id === draggingNodeId) {\n          const deltaX = newX - n.position.x;\n          const deltaY = newY - n.position.y;\n          // 如果是 phase，將其內部所有子節點也一起移動\n          if (n.type === \"phase\" && n.children && Array.isArray(n.children)) {\n            prevNodes = prevNodes.map(child => {\n              if (n.children.includes(child.id)) {\n                return {\n                  ...child,\n                  position: {\n                    x: child.position.x + deltaX,\n                    y: child.position.y + deltaY\n                  }\n                };\n              }\n              return child;\n            });\n          }\n          return {\n            ...n,\n            position: {\n              x: newX,\n              y: newY\n            }\n          };\n        }\n        return n;\n      }));\n    }\n    // 若正在調整大小\n    if (resizingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newWidth = Math.max(50, initialSize.width + (e.clientX - containerRect.left - resizeStart.x));\n      const newHeight = Math.max(30, initialSize.height + (e.clientY - containerRect.top - resizeStart.y));\n      setNodes(prevNodes => prevNodes.map(n => n.id === resizingNodeId ? {\n        ...n,\n        width: newWidth,\n        height: newHeight\n      } : n));\n    }\n  };\n  const handleMouseUp = () => {\n    // 拖曳結束後，若拖曳的是 phase，重新計算 phase 尺寸以包住其子節點\n    if (draggingNodeId) {\n      const dragged = nodes.find(n => n.id === draggingNodeId);\n      if (dragged && dragged.type === \"phase\") {\n        // 找出所有子節點位置\n        const childrenNodes = nodes.filter(n => dragged.children && dragged.children.includes(n.id));\n        if (childrenNodes.length > 0) {\n          const xs = childrenNodes.map(n => n.position.x);\n          const ys = childrenNodes.map(n => n.position.y);\n          const widths = childrenNodes.map(n => getNodeSize(n).width);\n          const heights = childrenNodes.map(n => getNodeSize(n).height);\n          const minX = Math.min(...xs) - PHASE_PADDING;\n          const minY = Math.min(...ys) - PHASE_PADDING;\n          const maxX = Math.max(...xs.map((x, i) => x + widths[i])) + PHASE_PADDING;\n          const maxY = Math.max(...ys.map((y, i) => y + heights[i])) + PHASE_PADDING;\n          setNodes(prevNodes => prevNodes.map(n => n.id === dragged.id ? {\n            ...n,\n            position: {\n              x: minX,\n              y: minY\n            },\n            width: maxX - minX,\n            height: maxY - minY\n          } : n));\n        }\n      }\n    }\n    setDraggingNodeId(null);\n    setResizingNodeId(null);\n  };\n\n  // 點選節點進行選取\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點，並從所有 phase 的 children 移除\n  const handleDeleteNode = nodeId => {\n    setNodes(prevNodes => prevNodes.filter(n => n.id !== nodeId).map(n => n.children && Array.isArray(n.children) ? {\n      ...n,\n      children: n.children.filter(cid => cid !== nodeId)\n    } : n));\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 開始調整大小（拖曳右下角）\n  const handleResizeMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    setResizingNodeId(nodeId);\n    const containerRect = containerRef.current.getBoundingClientRect();\n    setResizeStart({\n      x: e.clientX - containerRect.left,\n      y: e.clientY - containerRect.top\n    });\n    const node = nodes.find(n => n.id === nodeId);\n    if (node) {\n      const size = getNodeSize(node);\n      setInitialSize(size);\n    }\n  };\n\n  // 側邊編輯：更新被選節點的基本屬性\n  const handleEditChange = e => {\n    if (!selectedNodeId) return;\n    const {\n      name,\n      value\n    } = e.target;\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      [name]: value\n    } : n));\n  };\n\n  // 特別處理 children：以逗號分隔的字串轉為陣列\n  const handleChildrenChange = e => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes => prevNodes.map(n => n.id === selectedNodeId ? {\n      ...n,\n      children\n    } : n));\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\",\n      // 預設為 task，可後續調整\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: {\n        x: 50,\n        y: 50\n      },\n      ...DEFAULT_SIZE\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`, {\n        flowChart: nodes\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 畫連線：根據父節點的 children，從父節點中心連到子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const parentSize = getNodeSize(parent);\n            const childSize = getNodeSize(child);\n            const startX = parent.position.x + parentSize.width / 2;\n            const startY = parent.position.y + parentSize.height / 2;\n            const endX = child.position.x + childSize.width / 2;\n            const endY = child.position.y + childSize.height / 2;\n            lines.push(/*#__PURE__*/_jsxDEV(\"line\", {\n              x1: startX,\n              y1: startY,\n              x2: endX,\n              y2: endY,\n              stroke: \"black\",\n              strokeWidth: \"2\"\n            }, `line-${parent.id}-${child.id}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 15\n            }, this));\n          }\n        });\n      }\n    });\n    return lines;\n  };\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Custom Flow Chart Editor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddNode,\n        children: \"Add Node\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSave,\n        style: {\n          marginLeft: \"10px\"\n        },\n        children: \"Save Flow Chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        position: \"relative\",\n        width: \"100%\",\n        height: \"600px\",\n        border: \"1px solid #ccc\",\n        overflow: \"hidden\"\n      },\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        style: {\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\"\n        },\n        children: renderConnections()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), nodes.map(node => {\n        const size = getNodeSize(node);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"absolute\",\n            left: node.position.x,\n            top: node.position.y,\n            width: size.width,\n            height: size.height,\n            boxSizing: \"border-box\",\n            cursor: \"move\",\n            border: selectedNode && selectedNode.id === node.id ? \"2px solid blue\" : \"none\"\n          },\n          onMouseDown: e => handleMouseDown(e, node.id),\n          onClick: e => handleSelectNode(e, node.id),\n          children: [renderNodeContent(node), /*#__PURE__*/_jsxDEV(\"button\", {\n            style: {\n              position: \"absolute\",\n              top: 0,\n              right: 0,\n              backgroundColor: \"red\",\n              color: \"#fff\",\n              border: \"none\",\n              cursor: \"pointer\",\n              fontSize: \"10px\",\n              padding: \"2px\"\n            },\n            onClick: e => {\n              e.stopPropagation();\n              handleDeleteNode(node.id);\n            },\n            children: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 15\n          }, this), selectedNode && selectedNode.id === node.id && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: \"absolute\",\n              width: RESIZE_HANDLE_SIZE,\n              height: RESIZE_HANDLE_SIZE,\n              right: 0,\n              bottom: 0,\n              backgroundColor: \"gray\",\n              cursor: \"nwse-resize\"\n            },\n            onMouseDown: e => handleResizeMouseDown(e, node.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 17\n          }, this)]\n        }, node.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 7\n    }, this), selectedNode && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"20px\",\n        border: \"1px solid #ccc\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Edit Node Properties\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Type:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"type\",\n          value: selectedNode.type,\n          onChange: handleEditChange,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"phase\",\n            children: \"phase\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"task\",\n            children: \"task\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"subFlow\",\n            children: \"subFlow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"iterative\",\n            children: \"iterative\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"note\",\n            children: \"note\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"extra\",\n            children: \"extra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Label:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"label\",\n          value: selectedNode.label,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Description:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          value: selectedNode.description,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Link:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"link\",\n          value: selectedNode.link,\n          onChange: handleEditChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Children (comma-separated IDs):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: (selectedNode.children || []).join(\",\"),\n          onChange: handleChildrenChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Extras (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"extras\",\n          value: (selectedNode.extras || []).join(\",\"),\n          onChange: e => {\n            const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n            handleEditChange({\n              target: {\n                name: \"extras\",\n                value: arr\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 289,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomFlowChartEditor, \"IuFZcyexwonCQc45dMRBHwG2szo=\", false, function () {\n  return [useParams];\n});\n_c = CustomFlowChartEditor;\nexport default CustomFlowChartEditor;\nvar _c;\n$RefreshReg$(_c, \"CustomFlowChartEditor\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","useParams","jsxDEV","_jsxDEV","DEFAULT_SIZE","width","height","PHASE_SIZE","RESIZE_HANDLE_SIZE","PHASE_PADDING","getNodeSize","node","type","renderNodeContent","commonStyle","padding","textAlign","fontSize","boxSizing","style","border","backgroundColor","overflow","children","fontWeight","label","fileName","_jsxFileName","lineNumber","columnNumber","description","important","color","fontStyle","text","content","CustomFlowChartEditor","_s","id","projectId","token","localStorage","getItem","API_URL","process","env","REACT_APP_API_URL","containerRef","nodes","setNodes","selectedNodeId","setSelectedNodeId","draggingNodeId","setDraggingNodeId","dragOffset","setDragOffset","x","y","resizingNodeId","setResizingNodeId","resizeStart","setResizeStart","initialSize","setInitialSize","fetchFlowChart","res","get","headers","Authorization","data","error","console","handleMouseMove","e","containerRect","current","getBoundingClientRect","newX","clientX","left","newY","clientY","top","prevNodes","map","n","deltaX","position","deltaY","Array","isArray","child","includes","newWidth","Math","max","newHeight","handleMouseUp","dragged","find","childrenNodes","filter","length","xs","ys","widths","heights","minX","min","minY","maxX","i","maxY","handleSelectNode","nodeId","stopPropagation","handleDeleteNode","cid","handleResizeMouseDown","size","handleEditChange","name","value","target","handleChildrenChange","split","s","trim","handleAddNode","newNode","Date","now","extras","link","prev","handleSave","put","flowChart","alert","renderConnections","lines","forEach","parent","childId","parentSize","childSize","startX","startY","endX","endY","push","x1","y1","x2","y2","stroke","strokeWidth","selectedNode","marginBottom","onClick","marginLeft","ref","onMouseMove","onMouseUp","cursor","onMouseDown","handleMouseDown","right","bottom","marginTop","onChange","join","arr","_c","$RefreshReg$"],"sources":["/Users/chenguanyu/Desktop/yuniver_CRUD/client/src/pages/FlowChartEditor.jsx"],"sourcesContent":["// src/pages/CustomFlowChartEditor.jsx\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\n\n// 預設尺寸與 Phase 尺寸\nconst DEFAULT_SIZE = { width: 140, height: 80 };\nconst PHASE_SIZE = { width: 300, height: 200 };\nconst RESIZE_HANDLE_SIZE = 10;\nconst PHASE_PADDING = 20; // Phase 自動包覆子節點時的額外邊距\n\n// 根據節點 type 與是否有手動調整過尺寸，決定實際尺寸\nconst getNodeSize = (node) => {\n  if (node.width && node.height) {\n    return { width: node.width, height: node.height };\n  }\n  return node.type === 'phase' ? PHASE_SIZE : DEFAULT_SIZE;\n};\n\n// 根據 type 產生不同的節點內容與樣式\nconst renderNodeContent = (node) => {\n  const commonStyle = { padding: \"4px\", textAlign: \"center\", fontSize: \"12px\", height: \"100%\", boxSizing:\"border-box\" };\n  switch(node.type) {\n    case \"phase\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px dashed blue\", backgroundColor: \"#e0f7ff\", overflow:\"hidden\" }}>\n          <div style={{ fontWeight: \"bold\", fontSize: \"14px\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"task\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px solid black\", backgroundColor: \"#fff\" }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          {node.important && <div style={{ color: \"red\" }}>Important</div>}\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"subFlow\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px solid gray\", backgroundColor: \"#f0f0f0\" }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"iterative\":\n      return (\n        <div style={{ ...commonStyle, border: \"2px dotted green\", backgroundColor: \"#e8ffe8\" }}>\n          <div style={{ fontWeight: \"bold\" }}>{node.label} 🔄</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"note\":\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid orange\", backgroundColor: \"#fff7d6\" }}>\n          <div style={{ fontStyle: \"italic\" }}>{node.text || node.label}</div>\n          <div>{node.description}</div>\n        </div>\n      );\n    case \"extra\":\n      return (\n        <div style={{ ...commonStyle, fontSize:\"10px\" }}>\n          • {node.content}\n        </div>\n      );\n    default:\n      return (\n        <div style={{ ...commonStyle, border: \"1px solid black\" }}>\n          {node.label || \"No Label\"}\n        </div>\n      );\n  }\n};\n\nconst CustomFlowChartEditor = () => {\n  const { id: projectId } = useParams();\n  const token = localStorage.getItem('token');\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5001/api';\n  const containerRef = useRef(null);\n\n  // 所有節點資料，格式包含：id, type, label, description, extras, link, children, position, width, height\n  const [nodes, setNodes] = useState([]);\n  // 選取狀態\n  const [selectedNodeId, setSelectedNodeId] = useState(null);\n  // 拖曳狀態\n  const [draggingNodeId, setDraggingNodeId] = useState(null);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  // 調整大小狀態\n  const [resizingNodeId, setResizingNodeId] = useState(null);\n  const [resizeStart, setResizeStart] = useState({ x: 0, y: 0 });\n  const [initialSize, setInitialSize] = useState({ width: 0, height: 0 });\n\n  // 讀取流程圖資料\n  useEffect(() => {\n    const fetchFlowChart = async () => {\n      try {\n        const res = await axios.get(`${API_URL}/projects/${projectId}/flowchart`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        setNodes(res.data || []);\n      } catch (error) {\n        console.error(\"Failed to load flowchart:\", error);\n      }\n    };\n    fetchFlowChart();\n  }, [projectId, API_URL, token]);\n\n  // 依據拖曳狀態更新節點位置\n  const handleMouseMove = (e) => {\n    // 若正在拖曳\n    if (draggingNodeId && !resizingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newX = e.clientX - containerRect.left - dragOffset.x;\n      const newY = e.clientY - containerRect.top - dragOffset.y;\n      setNodes(prevNodes =>\n        prevNodes.map(n => {\n          if (n.id === draggingNodeId) {\n            const deltaX = newX - n.position.x;\n            const deltaY = newY - n.position.y;\n            // 如果是 phase，將其內部所有子節點也一起移動\n            if (n.type === \"phase\" && n.children && Array.isArray(n.children)) {\n              prevNodes = prevNodes.map(child => {\n                if (n.children.includes(child.id)) {\n                  return { ...child, position: { x: child.position.x + deltaX, y: child.position.y + deltaY } };\n                }\n                return child;\n              });\n            }\n            return { ...n, position: { x: newX, y: newY } };\n          }\n          return n;\n        })\n      );\n    }\n    // 若正在調整大小\n    if (resizingNodeId) {\n      const containerRect = containerRef.current.getBoundingClientRect();\n      const newWidth = Math.max(50, initialSize.width + (e.clientX - containerRect.left - resizeStart.x));\n      const newHeight = Math.max(30, initialSize.height + (e.clientY - containerRect.top - resizeStart.y));\n      setNodes(prevNodes =>\n        prevNodes.map(n => n.id === resizingNodeId ? { ...n, width: newWidth, height: newHeight } : n)\n      );\n    }\n  };\n\n  const handleMouseUp = () => {\n    // 拖曳結束後，若拖曳的是 phase，重新計算 phase 尺寸以包住其子節點\n    if (draggingNodeId) {\n      const dragged = nodes.find(n => n.id === draggingNodeId);\n      if (dragged && dragged.type === \"phase\") {\n        // 找出所有子節點位置\n        const childrenNodes = nodes.filter(n => dragged.children && dragged.children.includes(n.id));\n        if (childrenNodes.length > 0) {\n          const xs = childrenNodes.map(n => n.position.x);\n          const ys = childrenNodes.map(n => n.position.y);\n          const widths = childrenNodes.map(n => getNodeSize(n).width);\n          const heights = childrenNodes.map(n => getNodeSize(n).height);\n          const minX = Math.min(...xs) - PHASE_PADDING;\n          const minY = Math.min(...ys) - PHASE_PADDING;\n          const maxX = Math.max(...xs.map((x, i) => x + widths[i])) + PHASE_PADDING;\n          const maxY = Math.max(...ys.map((y, i) => y + heights[i])) + PHASE_PADDING;\n          setNodes(prevNodes =>\n            prevNodes.map(n =>\n              n.id === dragged.id ? { ...n, position: { x: minX, y: minY }, width: maxX - minX, height: maxY - minY } : n\n            )\n          );\n        }\n      }\n    }\n    setDraggingNodeId(null);\n    setResizingNodeId(null);\n  };\n\n  // 點選節點進行選取\n  const handleSelectNode = (e, nodeId) => {\n    e.stopPropagation();\n    setSelectedNodeId(nodeId);\n  };\n\n  // 刪除節點，並從所有 phase 的 children 移除\n  const handleDeleteNode = (nodeId) => {\n    setNodes(prevNodes => prevNodes\n      .filter(n => n.id !== nodeId)\n      .map(n => n.children && Array.isArray(n.children) ? { ...n, children: n.children.filter(cid => cid !== nodeId) } : n)\n    );\n    if (selectedNodeId === nodeId) setSelectedNodeId(null);\n  };\n\n  // 開始調整大小（拖曳右下角）\n  const handleResizeMouseDown = (e, nodeId) => {\n    e.stopPropagation();\n    setResizingNodeId(nodeId);\n    const containerRect = containerRef.current.getBoundingClientRect();\n    setResizeStart({ x: e.clientX - containerRect.left, y: e.clientY - containerRect.top });\n    const node = nodes.find(n => n.id === nodeId);\n    if (node) {\n      const size = getNodeSize(node);\n      setInitialSize(size);\n    }\n  };\n\n  // 側邊編輯：更新被選節點的基本屬性\n  const handleEditChange = (e) => {\n    if (!selectedNodeId) return;\n    const { name, value } = e.target;\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, [name]: value } : n\n      )\n    );\n  };\n\n  // 特別處理 children：以逗號分隔的字串轉為陣列\n  const handleChildrenChange = (e) => {\n    if (!selectedNodeId) return;\n    const children = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n    setNodes(prevNodes =>\n      prevNodes.map(n =>\n        n.id === selectedNodeId ? { ...n, children } : n\n      )\n    );\n  };\n\n  // 新增節點\n  const handleAddNode = () => {\n    const newNode = {\n      id: `${Date.now()}`,\n      type: \"task\", // 預設為 task，可後續調整\n      label: \"New Node\",\n      description: \"\",\n      extras: [],\n      link: \"\",\n      children: [],\n      position: { x: 50, y: 50 },\n      ...DEFAULT_SIZE\n    };\n    setNodes(prev => [...prev, newNode]);\n  };\n\n  // 儲存流程圖到後端\n  const handleSave = async () => {\n    try {\n      await axios.put(`${API_URL}/projects/${projectId}/flowchart`,\n        { flowChart: nodes },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      alert(\"Flowchart saved successfully!\");\n    } catch (error) {\n      console.error(\"Failed to save flowchart:\", error);\n      alert(\"Save failed.\");\n    }\n  };\n\n  // 畫連線：根據父節點的 children，從父節點中心連到子節點中心\n  const renderConnections = () => {\n    const lines = [];\n    nodes.forEach(parent => {\n      if (parent.children && Array.isArray(parent.children)) {\n        parent.children.forEach(childId => {\n          const child = nodes.find(n => n.id === childId);\n          if (child) {\n            const parentSize = getNodeSize(parent);\n            const childSize = getNodeSize(child);\n            const startX = parent.position.x + parentSize.width / 2;\n            const startY = parent.position.y + parentSize.height / 2;\n            const endX = child.position.x + childSize.width / 2;\n            const endY = child.position.y + childSize.height / 2;\n            lines.push(\n              <line\n                key={`line-${parent.id}-${child.id}`}\n                x1={startX}\n                y1={startY}\n                x2={endX}\n                y2={endY}\n                stroke=\"black\"\n                strokeWidth=\"2\"\n              />\n            );\n          }\n        });\n      }\n    });\n    return lines;\n  };\n\n  const selectedNode = nodes.find(n => n.id === selectedNodeId);\n\n  return (\n    <div>\n      <h2>Custom Flow Chart Editor</h2>\n      <div style={{ marginBottom: \"10px\" }}>\n        <button onClick={handleAddNode}>Add Node</button>\n        <button onClick={handleSave} style={{ marginLeft: \"10px\" }}>Save Flow Chart</button>\n      </div>\n      <div\n        ref={containerRef}\n        style={{ position: \"relative\", width: \"100%\", height: \"600px\", border: \"1px solid #ccc\", overflow: \"hidden\" }}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n      >\n        <svg style={{ position: \"absolute\", top: 0, left: 0, width: \"100%\", height: \"100%\" }}>\n          {renderConnections()}\n        </svg>\n        {nodes.map(node => {\n          const size = getNodeSize(node);\n          return (\n            <div\n              key={node.id}\n              style={{\n                position: \"absolute\",\n                left: node.position.x,\n                top: node.position.y,\n                width: size.width,\n                height: size.height,\n                boxSizing: \"border-box\",\n                cursor: \"move\",\n                border: selectedNode && selectedNode.id === node.id ? \"2px solid blue\" : \"none\"\n              }}\n              onMouseDown={(e) => handleMouseDown(e, node.id)}\n              onClick={(e) => handleSelectNode(e, node.id)}\n            >\n              {renderNodeContent(node)}\n              {/* 刪除按鈕 */}\n              <button\n                style={{\n                  position: \"absolute\",\n                  top: 0,\n                  right: 0,\n                  backgroundColor: \"red\",\n                  color: \"#fff\",\n                  border: \"none\",\n                  cursor: \"pointer\",\n                  fontSize: \"10px\",\n                  padding: \"2px\"\n                }}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleDeleteNode(node.id);\n                }}\n              >\n                X\n              </button>\n              {/* 若該節點被選中，顯示 resize handle */}\n              {selectedNode && selectedNode.id === node.id && (\n                <div\n                  style={{\n                    position: \"absolute\",\n                    width: RESIZE_HANDLE_SIZE,\n                    height: RESIZE_HANDLE_SIZE,\n                    right: 0,\n                    bottom: 0,\n                    backgroundColor: \"gray\",\n                    cursor: \"nwse-resize\"\n                  }}\n                  onMouseDown={(e) => handleResizeMouseDown(e, node.id)}\n                />\n              )}\n            </div>\n          );\n        })}\n      </div>\n      {selectedNode && (\n        <div style={{ marginTop: \"20px\", border: \"1px solid #ccc\", padding: \"10px\" }}>\n          <h3>Edit Node Properties</h3>\n          <div>\n            <label>Type:</label>\n            <select name=\"type\" value={selectedNode.type} onChange={handleEditChange}>\n              <option value=\"phase\">phase</option>\n              <option value=\"task\">task</option>\n              <option value=\"subFlow\">subFlow</option>\n              <option value=\"iterative\">iterative</option>\n              <option value=\"note\">note</option>\n              <option value=\"extra\">extra</option>\n            </select>\n          </div>\n          <div>\n            <label>Label:</label>\n            <input name=\"label\" value={selectedNode.label} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Description:</label>\n            <textarea name=\"description\" value={selectedNode.description} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Link:</label>\n            <input name=\"link\" value={selectedNode.link} onChange={handleEditChange} />\n          </div>\n          <div>\n            <label>Children (comma-separated IDs):</label>\n            <input\n              value={(selectedNode.children || []).join(\",\")}\n              onChange={handleChildrenChange}\n            />\n          </div>\n          <div>\n            <label>Extras (comma-separated):</label>\n            <input\n              name=\"extras\"\n              value={(selectedNode.extras || []).join(\",\")}\n              onChange={(e) => {\n                const arr = e.target.value.split(\",\").map(s => s.trim()).filter(s => s);\n                handleEditChange({ target: { name: \"extras\", value: arr } });\n              }}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CustomFlowChartEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}